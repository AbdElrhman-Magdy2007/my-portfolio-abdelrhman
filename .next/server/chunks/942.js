exports.id=942,exports.ids=[942],exports.modules={12597:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(18962).A)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},13861:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(18962).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},13964:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(18962).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},18853:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var a=r(43210),i=r(66156);function n(e){let[t,r]=a.useState(void 0);return(0,i.N)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let a,i;if(!Array.isArray(t)||!t.length)return;let n=t[0];if("borderBoxSize"in n){let e=n.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,i=t.blockSize}else a=e.offsetWidth,i=e.offsetHeight;r({width:a,height:i})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}},20932:(e,t,r)=>{"use strict";r.d(t,{default:()=>v});var a=r(60687),i=r(75109),n=r(28670),o=r(30474),s=r(29523),l=r(96330),d=r(43210),c=r(6475);let u=(0,c.createServerReference)("7f1cc0a283f6cb3671dcffd6b0c729196e81c52dab",c.callServer,void 0,c.findSourceMapURL,"updateProfile");var f=r(43125),p=r(51361),m=r(52581),h=r(82136),g=r(77181),y=r(40211),b=r(19184),x=r(49384);let v=function({user:e}){let{data:t,update:r}=(0,h.useSession)(),[c,p]=(0,d.useState)(e.image??""),[v,k]=(0,d.useState)(e.role===l.UserRole.ADMIN),[w,A]=(0,d.useState)(null),C=(0,d.useCallback)(()=>{let t=new FormData;return Object.entries(e).forEach(([e,r])=>{null!=r&&"image"!==e&&t.append(e,r.toString())}),t},[e]),S={message:"",error:{},status:null,formData:C()},[N,E,R]=(0,d.useActionState)(u.bind(null,v),S),{getFormFields:z}=(0,n.A)({slug:i.BV.PROFILE}),I=(0,d.useCallback)(e=>{e.preventDefault();let t="Saving...";t!==w&&(m.oR.loading(t,{id:"profile-update-loading",style:{borderRadius:"8px",padding:"12px",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb"}}),A(t)),(0,d.startTransition)(()=>{E(new FormData(e.currentTarget))})},[E,w]);return(0,a.jsxs)(b.P.form,{onSubmit:I,className:"flex flex-col md:flex-row gap-10 p-6 bg-black shadow-lg rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,a.jsxs)(b.P.div,{className:"group relative w-[200px] h-[200px] overflow-hidden rounded-full mx-auto border-2 border-indigo-700",whileHover:{scale:1.05},children:[c?(0,a.jsx)(o.default,{src:c,alt:e.name??"User Avatar",width:200,height:200,className:"rounded-full object-cover"}):(0,a.jsx)(o.default,{src:"https://i.postimg.cc/kg2xytVs/610e8961bbb935274c005c6106a78a38.jpg",alt:"Default Cat Avatar",width:200,height:200,className:"rounded-full object-cover"}),(0,a.jsx)("div",{className:(0,x.A)("absolute top-0 left-0 w-full h-full flex items-center justify-center rounded-full transition-opacity duration-200",c&&"group-hover:opacity-100 opacity-0 transition-opacity duration-200"),children:(0,a.jsx)(j,{setSelectedImage:p})})]}),(0,a.jsxs)(b.P.div,{className:"flex-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[z().map(e=>{let t=N?.formData?.get(e.name)??C().get(e.name);return(0,a.jsx)(b.P.div,{className:"mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,a.jsx)(g.A,{...e,type:e.type,defaultValue:t,error:N?.error?.[e.name]?.join(", "),readonly:e.type===i.gN.EMAIL,disabled:R})},e.name)}),t?.user.role===l.UserRole.ADMIN&&(0,a.jsxs)(b.P.div,{className:"flex items-center gap-2 my-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[(0,a.jsx)(y.Sc,{id:"admin",name:"admin",checked:v,onCheckedChange:e=>k(e),className:(0,x.A)("w-5 h-5 border-2 rounded-md transition-all",v?"bg-indigo-700 border-indigo-700":"bg-black border-black")}),(0,a.jsx)("label",{htmlFor:"admin",className:"text-indigo-700 font-medium cursor-pointer",children:"Admin"})]}),(0,a.jsx)(b.P.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3},children:(0,a.jsx)(s.$,{type:"submit",disabled:R,className:(0,x.A)("w-full bg-indigo-700 hover:bg-indigo-700 text-black font-bold py-2 px-4 rounded-lg transition-all",R&&"opacity-50 cursor-not-allowed flex items-center justify-center gap-2"),children:R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Saving..."})]}):"Save"})})]})]})},j=({setSelectedImage:e})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:t=>{let r=t.target.files?.[0];r&&e(URL.createObjectURL(r))},name:"image"}),(0,a.jsx)("label",{htmlFor:"image-upload",className:"flex justify-center items-center w-full h-full cursor-pointer ml-1 rounded-full hover:bg-indigo-700/700 transition-all",children:(0,a.jsx)(p.A,{className:"w-10 h-10 text-indigo-700"})})]})},30474:(e,t,r)=>{"use strict";r.d(t,{default:()=>i.a});var a=r(31261),i=r.n(a)},31261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return s}});let a=r(14985),i=r(44953),n=r(46533),o=a._(r(1933));function s(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=n.Image},40211:(e,t,r)=>{"use strict";r.d(t,{C1:()=>w,Sc:()=>j,bL:()=>j});var a=r(43210),i=r(98599),n=r(11273),o=r(70569),s=r(65551),l=r(83721),d=r(18853),c=r(46059),u=r(14163),f=r(60687),p="Checkbox",[m,h]=(0,n.A)(p),[g,y]=m(p);function b(e){let{__scopeCheckbox:t,checked:r,children:i,defaultChecked:n,disabled:o,form:l,name:d,onCheckedChange:c,required:u,value:m="on",internal_do_not_use_render:h}=e,[y,b]=(0,s.i)({prop:r,defaultProp:n??!1,onChange:c,caller:p}),[x,v]=a.useState(null),[j,k]=a.useState(null),w=a.useRef(!1),A=!x||!!l||!!x.closest("form"),C={checked:y,disabled:o,setChecked:b,control:x,setControl:v,name:d,form:l,value:m,hasConsumerStoppedPropagationRef:w,required:u,defaultChecked:!S(n)&&n,isFormControl:A,bubbleInput:j,setBubbleInput:k};return(0,f.jsx)(g,{scope:t,...C,children:"function"==typeof h?h(C):i})}var x="CheckboxTrigger",v=a.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},s)=>{let{control:l,value:d,disabled:c,checked:p,required:m,setControl:h,setChecked:g,hasConsumerStoppedPropagationRef:b,isFormControl:v,bubbleInput:j}=y(x,e),k=(0,i.s)(s,h),w=a.useRef(p);return a.useEffect(()=>{let e=l?.form;if(e){let t=()=>g(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[l,g]),(0,f.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":S(p)?"mixed":p,"aria-required":m,"data-state":N(p),"data-disabled":c?"":void 0,disabled:c,value:d,...n,ref:k,onKeyDown:(0,o.m)(t,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,o.m)(r,e=>{g(e=>!!S(e)||!e),j&&v&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});v.displayName=x;var j=a.forwardRef((e,t)=>{let{__scopeCheckbox:r,name:a,checked:i,defaultChecked:n,required:o,disabled:s,value:l,onCheckedChange:d,form:c,...u}=e;return(0,f.jsx)(b,{__scopeCheckbox:r,checked:i,defaultChecked:n,disabled:s,required:o,onCheckedChange:d,name:a,form:c,value:l,internal_do_not_use_render:({isFormControl:e})=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(v,{...u,ref:t,__scopeCheckbox:r}),e&&(0,f.jsx)(C,{__scopeCheckbox:r})]})})});j.displayName=p;var k="CheckboxIndicator",w=a.forwardRef((e,t)=>{let{__scopeCheckbox:r,forceMount:a,...i}=e,n=y(k,r);return(0,f.jsx)(c.C,{present:a||S(n.checked)||!0===n.checked,children:(0,f.jsx)(u.sG.span,{"data-state":N(n.checked),"data-disabled":n.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});w.displayName=k;var A="CheckboxBubbleInput",C=a.forwardRef(({__scopeCheckbox:e,...t},r)=>{let{control:n,hasConsumerStoppedPropagationRef:o,checked:s,defaultChecked:c,required:p,disabled:m,name:h,value:g,form:b,bubbleInput:x,setBubbleInput:v}=y(A,e),j=(0,i.s)(r,v),k=(0,l.Z)(s),w=(0,d.X)(n);a.useEffect(()=>{if(!x)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!o.current;if(k!==s&&e){let r=new Event("click",{bubbles:t});x.indeterminate=S(s),e.call(x,!S(s)&&s),x.dispatchEvent(r)}},[x,k,s,o]);let C=a.useRef(!S(s)&&s);return(0,f.jsx)(u.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??C.current,required:p,disabled:m,name:h,value:g,form:b,...t,tabIndex:-1,ref:j,style:{...t.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function S(e){return"indeterminate"===e}function N(e){return S(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=A},40724:(e,t,r)=>{Promise.resolve().then(r.bind(r,86384))},51361:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(18962).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},83721:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(43210);function i(e){let t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},86384:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\raya\\\\ShoppingCart\\\\portfolio - Copy - Copy - Copy\\\\src\\\\components\\\\edit-user-form\\\\index.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy\\src\\components\\edit-user-form\\index.tsx","default")},93460:(e,t,r)=>{Promise.resolve().then(r.bind(r,20932))},96561:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"7f1cc0a283f6cb3671dcffd6b0c729196e81c52dab":()=>u});var a=r(91199);r(42087);var i=r(16672);let n=()=>i.z.object({name:i.z.string().trim().min(1,{message:"Name is required"}),email:i.z.string().trim().email({message:"Invalid email format"}),phone:i.z.string().trim().optional().refine(e=>!e||/^\+?[1-9]\d{1,14}$/.test(e),{message:"Invalid phone number"}),streetAddress:i.z.string().trim().optional(),postalCode:i.z.string().trim().optional().refine(e=>!e||/^\d{5,10}$/.test(e),{message:"Invalid postal code"}),city:i.z.string().trim().optional(),country:i.z.string().trim().optional(),image:i.z.any().optional().refine(e=>!e||"string"==typeof e||"undefined"!=typeof Blob&&e instanceof Blob&&e.size<=2097152&&e.type?.startsWith("image/"),{message:"Image must be under 2MB and of valid format"})});var o=r(70664),s=r(7944),l=r(56728),d=r(96330),c=r(33331);let u=async(e,t,r)=>{let a,i=n().safeParse(Object.fromEntries(r.entries()));if(!i.success)return{error:i.error.formErrors.fieldErrors,formData:r};let c=i.data,u=c.image;"string"==typeof u?a=u:u instanceof Blob&&u.size>0&&(a=await f(u));try{let t=await o.db.user.findUnique({where:{email:c.email},select:{id:!0,email:!0,image:!0}});if(!t)return{message:"User not found",status:401,formData:r};return await o.db.user.update({where:{email:t.email},data:{name:c.name,phone:c.phone??null,streetAddress:c.streetAddress??null,postalCode:c.postalCode??null,city:c.city??null,country:c.country??null,image:a??t.image,role:e?d.UserRole.ADMIN:d.UserRole.USER}}),[`/${l.BV.PROFILE}`,`/${l.BV.ADMIN}`,`/${l.BV.ADMIN}/${l.bQ.USERS}`,`/${l.BV.ADMIN}/${l.bQ.USERS}/${t.id}/${l.bQ.EDIT}`].forEach(e=>(0,s.revalidatePath)(e)),{status:200,message:"Profile updated successfully"}}catch(e){return console.error("Update profile error:",e),{status:500,message:"An unexpected error occurred"}}},f=async e=>{if(e.size>5242880)throw Error("Image size exceeds 5MB limit");let t=new FormData;t.append("file",e),t.append("pathName","profile_images");try{let e=await fetch("http://localhost:3000/api/upload",{method:"POST",body:t});if(!e.ok)throw Error(`Upload failed: ${e.status}`);return(await e.json()).url}catch(e){console.warn("Upload error:",e);return}};(0,c.D)([u]),(0,a.A)(u,"7f1cc0a283f6cb3671dcffd6b0c729196e81c52dab",null)}};