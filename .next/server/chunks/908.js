exports.id=908,exports.ids=[908],exports.modules={92922:(e,t,a)=>{let r={"1a986ce833df300b0180d776df7b5eca165e992b":()=>Promise.resolve().then(a.bind(a,38053)).then(e=>e.$$ACTION_0),"911a95d22ddf42fb47f6d26d36fb01daa091dd52":()=>Promise.resolve().then(a.bind(a,38053)).then(e=>e.updateProfile)};async function i(e,...t){return(await r[e]()).apply(null,t)}e.exports={"1a986ce833df300b0180d776df7b5eca165e992b":i.bind(null,"1a986ce833df300b0180d776df7b5eca165e992b"),"911a95d22ddf42fb47f6d26d36fb01daa091dd52":i.bind(null,"911a95d22ddf42fb47f6d26d36fb01daa091dd52")}},73252:(e,t,a)=>{Promise.resolve().then(a.bind(a,93051))},51896:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(76557).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},46226:(e,t,a)=>{"use strict";a.d(t,{default:()=>i.a});var r=a(69029),i=a.n(r)},69029:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return l},getImageProps:function(){return s}});let r=a(91174),i=a(23078),n=a(92481),o=r._(a(86820));function s(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let l=n.Image},93051:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var r,i=a(10326),n=a(15616),o=a(5280),s=a(46226),l=a(91664),d=a(17577);a(15424);var c=(0,a(46242).$)("911a95d22ddf42fb47f6d26d36fb01daa091dd52"),u=a(3240),f=a(51896),m=a(85999),p=a(77109),g=a(94902),E=a(13635),b=a(60235),S=a(41135);!function(e){e.USER="USER",e.ADMIN="ADMIN"}(r||(r={}));let h=function({user:e}){let{data:t,update:a}=(0,p.useSession)(),[r,f]=(0,d.useState)(e.image??""),[h,y]=(0,d.useState)("ADMIN"===e.role),[A,I]=(0,d.useState)(null),[O,x]=(0,d.useState)([]),R=(0,d.useCallback)(()=>{let t=new FormData;return Object.entries(e).forEach(([e,a])=>{null!=a&&"image"!==e&&t.append(e,a.toString())}),t},[e]),C={message:"",error:{},status:null,formData:R()},[N,D,U]=(0,d.useActionState)(c.bind(null,h),C),{getFormFields:v}=(0,o.Z)({slug:n.Z5.PROFILE}),j=(0,d.useCallback)(e=>{e.preventDefault();let t="Saving...";t!==A&&(m.Am.loading(t,{id:"profile-update-loading",style:{borderRadius:"8px",padding:"12px",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb"}}),I(t)),(0,d.startTransition)(()=>{D(new FormData(e.currentTarget))})},[D,A]);return(0,i.jsxs)(b.E.form,{onSubmit:j,className:"flex flex-col md:flex-row gap-10 p-6 bg-black shadow-lg rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,i.jsxs)(b.E.div,{className:"group relative w-[200px] h-[200px] overflow-hidden rounded-full mx-auto border-2 border-indigo-700",whileHover:{scale:1.05},children:[r?i.jsx(s.default,{src:r,alt:e.name??"User Avatar",width:200,height:200,className:"rounded-full object-cover"}):i.jsx(s.default,{src:"https://i.postimg.cc/kg2xytVs/610e8961bbb935274c005c6106a78a38.jpg",alt:"Default Cat Avatar",width:200,height:200,className:"rounded-full object-cover"}),i.jsx("div",{className:(0,S.Z)("absolute top-0 left-0 w-full h-full flex items-center justify-center rounded-full transition-opacity duration-200",r&&"group-hover:opacity-100 opacity-0 transition-opacity duration-200"),children:i.jsx(T,{setSelectedImage:f})})]}),(0,i.jsxs)(b.E.div,{className:"flex-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[v().map(e=>{let t=N?.formData?.get(e.name)??R().get(e.name);return i.jsx(b.E.div,{className:"mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:i.jsx(g.Z,{...e,type:e.type,pattern:e.pattern??"",ariaLabel:e.ariaLabel??"",defaultValue:t,error:N?.error?.[e.name]?.join(", "),readonly:e.type===n.oP.EMAIL,disabled:U})},e.name)}),t?.user.role==="ADMIN"&&(0,i.jsxs)(b.E.div,{className:"flex items-center gap-2 my-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[i.jsx(E.XZ,{id:"admin",name:"admin",checked:h,onCheckedChange:e=>y(e),className:(0,S.Z)("w-5 h-5 border-2 rounded-md transition-all",h?"bg-indigo-700 border-indigo-700":"bg-black border-black")}),i.jsx("label",{htmlFor:"admin",className:"text-indigo-700 font-medium cursor-pointer",children:"Admin"})]}),i.jsx(b.E.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3},children:i.jsx(l.z,{type:"submit",disabled:U,className:(0,S.Z)("w-full bg-indigo-700 hover:bg-indigo-700 text-black font-bold py-2 px-4 rounded-lg transition-all",U&&"opacity-50 cursor-not-allowed flex items-center justify-center gap-2"),children:U?(0,i.jsxs)(i.Fragment,{children:[i.jsx(u.Z,{className:"w-5 h-5"}),i.jsx("span",{children:"Saving..."})]}):"Save"})})]})]})},T=({setSelectedImage:e})=>(0,i.jsxs)(i.Fragment,{children:[i.jsx("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:t=>{let a=t.target.files?.[0];a&&e(URL.createObjectURL(a))},name:"image"}),i.jsx("label",{htmlFor:"image-upload",className:"flex justify-center items-center w-full h-full cursor-pointer ml-1 rounded-full hover:bg-indigo-700/700 transition-all",children:i.jsx(f.Z,{className:"w-10 h-10 text-indigo-700"})})]})},38053:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$ACTION_0:()=>u,updateProfile:()=>c});var r=a(27745);a(26461);var i=a(67189);let n=()=>i.z.object({name:i.z.string().trim().min(1,{message:"Name is required"}),email:i.z.string().trim().email({message:"Invalid email format"}),phone:i.z.string().trim().optional().refine(e=>!e||/^\+?[1-9]\d{1,14}$/.test(e),{message:"Invalid phone number"}),streetAddress:i.z.string().trim().optional(),postalCode:i.z.string().trim().optional().refine(e=>!e||/^\d{5,10}$/.test(e),{message:"Invalid postal code"}),city:i.z.string().trim().optional(),country:i.z.string().trim().optional(),image:i.z.any().optional().refine(e=>!e||"string"==typeof e||"undefined"!=typeof Blob&&e instanceof Blob&&e.size<=2097152&&e.type?.startsWith("image/"),{message:"Image must be under 2MB and of valid format"})});var o=a(24831),s=a(30207),l=a(8316),d=a(85723);let c=(0,r.j)("1a986ce833df300b0180d776df7b5eca165e992b",u);async function u(e,t,a){let r;let i=n().safeParse(Object.fromEntries(a.entries()));if(!i.success)return{error:i.error.formErrors.fieldErrors,formData:a};let d=i.data,c=d.image;"string"==typeof c?r=c:c instanceof Blob&&c.size>0&&(r=await f(c));try{let t=await o._.user.findUnique({where:{email:d.email},select:{id:!0,email:!0,image:!0}});if(!t)return{message:"User not found",status:401,formData:a};return await o._.user.update({where:{email:t.email},data:{name:d.name,phone:d.phone??null,streetAddress:d.streetAddress??null,postalCode:d.postalCode??null,city:d.city??null,country:d.country??null,image:r??t.image,role:e?l.i4.ADMIN:l.i4.USER}}),[`/${l.Z5.PROFILE}`,`/${l.Z5.ADMIN}`,`/${l.Z5.ADMIN}/${l.iY.USERS}`,`/${l.Z5.ADMIN}/${l.iY.USERS}/${t.id}/${l.iY.EDIT}`].forEach(e=>(0,s.revalidatePath)(e)),{status:200,message:"Profile updated successfully"}}catch(e){return console.error("Update profile error:",e),{status:500,message:"An unexpected error occurred"}}}let f=async e=>{if(e.size>5242880)throw Error("Image size exceeds 5MB limit");let t=new FormData;t.append("file",e),t.append("pathName","profile_images");try{let e=await fetch("http://localhost:3000/api/upload",{method:"POST",body:t});if(!e.ok)throw Error(`Upload failed: ${e.status}`);return(await e.json()).url}catch(e){console.warn("Upload error:",e);return}};(0,d.h)([c]),(0,r.j)("911a95d22ddf42fb47f6d26d36fb01daa091dd52",c)},67347:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(68570).createProxy)(String.raw`C:\Users\raya\ShoppingCart\portfolio - Copy - Copy - Copy - Copy\src\components\edit-user-form\index.tsx#default`)},96690:(e,t,a)=>{"use strict";var r,i,n,o,s,l,d,c,u,f,m,p,g,E,b;a.d(t,{CQ:()=>g,Z5:()=>o,iY:()=>s,lI:()=>i}),function(e){e.RTL="rtl",e.LTR="ltr"}(r||(r={})),function(e){e.ENGLISH="en",e.ARABIC="ar"}(i||(i={})),(n||(n={})).EN="en",function(e){e.ROOT="",e.MENU="menu",e.ABOUT="about",e.CONTACT="contact",e.AUTH="auth",e.CART="cart",e.PROFILE="profile",e.ADMIN="admin",e.PORTFOLIO="PORTFOLIO",e.SETTINGS="SETTINGS"}(o||(o={})),function(e){e.LOGIN="/signin",e.Register="/signup",e.FORGOT_PASSWORD="forgot-password",e.CATEGORIES="categories",e.MENU_ITEMS="menu-items",e.USERS="users",e.ORDERS="orders",e.NEW="new",e.EDIT="edit",e.DASHBOARD="Dashboard",e.CUSTOMERS="Customers",e.SALES="Sales",e.PRODUCTS="PRODUCTS",e.LOGOUT="LOGOUT"}(s||(s={})),function(e){e.TEXT="text",e.PASSWORD="password",e.EMAIL="email",e.NUMBER="number",e.DATE="date",e.TIME="time",e.DATETIME_LOCAL="datetime-local",e.RADIO="radio",e.SELECT="select",e.TEXTAREA="textarea",e.FILE="file",e.COLOR="color",e.CHECKBOX="checkbox",e.RANGE="range",e.TEL="tel",e.URL="url",e.SEARCH="search",e.SUBMIT="submit",e.WEEK="week",e.MULTI_SELECT="multi-select",e.HIDDEN="hidden",e.BUTTON="button"}(l||(l={})),function(e){e.NEXT="next",e.PREV="prev"}(d||(d={})),function(e){e.SUCCESS="success",e.ERROR="error",e.WARNING="warning",e.INFO="info"}(c||(c={})),function(e){e.ASC="asc",e.DESC="desc"}(u||(u={})),function(e){e.NAME="name",e.CREATED_AT="created_at",e.UPDATED_AT="updated_at",e.EMAIL="email",e.PHONE="phone",e.STATUS="status",e.STATUS_DATE="status_date",e.END_DATE="end_date"}(f||(f={})),function(e){e.LOGIN_SUCCESS="login_success",e.LOGOUT_SUCCESS="logout_success",e.REGISTER_SUCCESS="register_success",e.FORGOT_PASSWORD="forgot_password",e.RESET_PASSWORD="reset_password",e.CHECK_EMAIL="check_email",e.VERIFY_EMAIL="verify_email"}(m||(m={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE"}(p||(p={})),function(e){e.PROD="production",e.DEV="development"}(g||(g={})),function(e){e.ADMIN="ADMIN",e.USER="USER"}(E||(E={})),function(e){e.FullStack="FullStack",e.Backend="Backend",e.Frontend="Frontend",e.UI="UI",e.UX="UX"}(b||(b={}))}};