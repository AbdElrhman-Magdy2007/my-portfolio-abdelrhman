(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698,3937,6636],{6654:(e,a,t)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"useMergedRef",{enumerable:!0,get:function(){return r}});let l=t(12115);function r(e,a){let t=(0,l.useRef)(null),r=(0,l.useRef)(null);return(0,l.useCallback)(l=>{if(null===l){let e=t.current;e&&(t.current=null,e());let a=r.current;a&&(r.current=null,a())}else e&&(t.current=n(e,l)),a&&(r.current=n(a,l))},[e,a])}function n(e,a){if("function"!=typeof e)return e.current=a,()=>{e.current=null};{let t=e(a);return"function"==typeof t?t:()=>e(null)}}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),e.exports=a.default)},18112:(e,a,t)=>{Promise.resolve().then(t.bind(t,53436))},53436:(e,a,t)=>{"use strict";t.d(a,{default:()=>v});var l=t(95155),r=t(53607),n=t(77052),i=t(66766),s=t(30285),o=t(46671),u=t(12115),d=t(34477);let c=(0,d.createServerReference)("7f55cda13ae6aa1a4c47953b9bad4e4f94f99a152d",d.callServer,void 0,d.findSourceMapURL,"updateProfile");var f=t(94631),m=t(84355),p=t(56671),g=t(12108),b=t(26446),h=t(76981),x=t(58918),y=t(52596);let v=function(e){var a,t;let{user:d}=e,{data:m,update:v}=(0,g.useSession)(),[N,w]=(0,u.useState)(null!=(a=d.image)?a:""),[R,k]=(0,u.useState)(d.role===o.UserRole.ADMIN),[S,A]=(0,u.useState)(null),P=(0,u.useCallback)(()=>{let e=new FormData;return Object.entries(d).forEach(a=>{let[t,l]=a;null!=l&&"image"!==t&&e.append(t,l.toString())}),e},[d]),_={message:"",error:{},status:null,formData:P()},[C,D,E]=(0,u.useActionState)(c.bind(null,R),_),{getFormFields:M}=(0,n.A)({slug:r.BV.PROFILE});(0,u.useEffect)(()=>{if(C.message&&"number"==typeof C.status&&!E&&C.message!==S){p.oR.dismiss("profile-update-loading");let e=200===C.status;p.oR[e?"success":"error"](C.message,{style:{color:e?"#34c759":"#ef4444",backgroundColor:e?"#f0fdf4":"#fef2f2",border:"1px solid ".concat(e?"#dcfce7":"#fee2e2"),borderRadius:"8px",padding:"12px"},duration:3e3}),A(C.message),e&&v({...m,user:{...null==m?void 0:m.user,role:R?o.UserRole.ADMIN:o.UserRole.USER,image:N}})}},[E,C.message,C.status,m,v,R,N,S]),(0,u.useEffect)(()=>{var e;w(null!=(e=d.image)?e:"")},[d.image]);let O=(0,u.useCallback)(e=>{e.preventDefault();let a="Saving...";a!==S&&(p.oR.loading(a,{id:"profile-update-loading",style:{borderRadius:"8px",padding:"12px",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb"}}),A(a)),(0,u.startTransition)(()=>{D(new FormData(e.currentTarget))})},[D,S]);return(0,l.jsxs)(x.P.form,{onSubmit:O,className:"flex flex-col md:flex-row gap-10 p-6 bg-black shadow-lg rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,l.jsxs)(x.P.div,{className:"group relative w-[200px] h-[200px] overflow-hidden rounded-full mx-auto border-2 border-indigo-700",whileHover:{scale:1.05},children:[N?(0,l.jsx)(i.default,{src:N,alt:null!=(t=d.name)?t:"User Avatar",width:200,height:200,className:"rounded-full object-cover"}):(0,l.jsx)(i.default,{src:"https://i.postimg.cc/kg2xytVs/610e8961bbb935274c005c6106a78a38.jpg",alt:"Default Cat Avatar",width:200,height:200,className:"rounded-full object-cover"}),(0,l.jsx)("div",{className:(0,y.A)("absolute top-0 left-0 w-full h-full flex items-center justify-center rounded-full transition-opacity duration-200",N&&"group-hover:opacity-100 opacity-0 transition-opacity duration-200"),children:(0,l.jsx)(j,{setSelectedImage:w})})]}),(0,l.jsxs)(x.P.div,{className:"flex-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[M().map(e=>{var a,t,n,i;let s=null!=(i=null==C||null==(a=C.formData)?void 0:a.get(e.name))?i:P().get(e.name);return(0,l.jsx)(x.P.div,{className:"mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,l.jsx)(b.A,{...e,type:e.type,defaultValue:s,error:null==C||null==(n=C.error)||null==(t=n[e.name])?void 0:t.join(", "),readonly:e.type===r.gN.EMAIL,disabled:E})},e.name)}),(null==m?void 0:m.user.role)===o.UserRole.ADMIN&&(0,l.jsxs)(x.P.div,{className:"flex items-center gap-2 my-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[(0,l.jsx)(h.Sc,{id:"admin",name:"admin",checked:R,onCheckedChange:e=>k(e),className:(0,y.A)("w-5 h-5 border-2 rounded-md transition-all",R?"bg-indigo-700 border-indigo-700":"bg-black border-black")}),(0,l.jsx)("label",{htmlFor:"admin",className:"text-indigo-700 font-medium cursor-pointer",children:"Admin"})]}),(0,l.jsx)(x.P.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3},children:(0,l.jsx)(s.$,{type:"submit",disabled:E,className:(0,y.A)("w-full bg-indigo-700 hover:bg-indigo-700 text-black font-bold py-2 px-4 rounded-lg transition-all",E&&"opacity-50 cursor-not-allowed flex items-center justify-center gap-2"),children:E?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"Saving..."})]}):"Save"})})]})]})},j=e=>{let{setSelectedImage:a}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:e=>{var t;let l=null==(t=e.target.files)?void 0:t[0];l&&a(URL.createObjectURL(l))},name:"image"}),(0,l.jsx)("label",{htmlFor:"image-upload",className:"flex justify-center items-center w-full h-full cursor-pointer ml-1 rounded-full hover:bg-indigo-700/700 transition-all",children:(0,l.jsx)(m.A,{className:"w-10 h-10 text-indigo-700"})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[9352,8918,6671,7951,3063,2108,3030,2563,8441,1684,7358],()=>a(18112)),_N_E=e.O()}]);