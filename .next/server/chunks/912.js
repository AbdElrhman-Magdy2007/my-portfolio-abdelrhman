"use strict";exports.id=912,exports.ids=[912],exports.modules={23732:(e,a,r)=>{r.d(a,{b:()=>i});var t=r(89605),o=r(31183);let i=(0,t.P)(async()=>{try{let e=await o.db.category.findMany({select:{id:!0,name:!0,order:!0},orderBy:{order:"asc"}});return console.log("Fetched categories:",e),e}catch(e){return console.error("Error fetching categories:",e),[]}},["categories"],{revalidate:3600})},32154:(e,a,r)=>{r.d(a,{default:()=>ec});var t=r(60687),o=r(43210),i=r(16189),n=r(19184),d=r(88920),s=r(96330),l=r(75109),c=r(28670),u=r(6475);let p=(0,u.createServerReference)("7f5d17a3c69a806267bbdf1348d85c4e2287242b1e",u.callServer,void 0,u.findSourceMapURL,"updateProduct"),m=(0,u.createServerReference)("7f86c3aae7be9af34f044b37529fe3eff2b5a3efb6",u.callServer,void 0,u.findSourceMapURL,"addProduct"),g=(0,u.createServerReference)("7fd87313ccd012edb02f7921a3095364ea6a8b73f2",u.callServer,void 0,u.findSourceMapURL,"deleteProduct");var f=r(52581),h=r(4780),x=r(85814),b=r.n(x),y=r(30474),v=r(29523),w=r(65734),j=r(78272);let A=w.bL,N=o.forwardRef(({className:e,...a},r)=>(0,t.jsx)(w.q7,{ref:r,className:(0,h.cn)("border-b",e),...a}));N.displayName="AccordionItem";let $=o.forwardRef(({className:e,children:a,...r},o)=>(0,t.jsx)(w.Y9,{className:"flex",children:(0,t.jsxs)(w.l9,{ref:o,className:(0,h.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...r,children:[a,(0,t.jsx)(j.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));$.displayName=w.l9.displayName;let P=o.forwardRef(({className:e,children:a,...r},o)=>(0,t.jsx)(w.UC,{ref:o,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,t.jsx)("div",{className:(0,h.cn)("pb-4 pt-0",e),children:a})}));P.displayName=w.UC.displayName;var C=r(97500),k=r(3589),I=r(13964);let S=C.bL,E=C.YJ,F=C.WT,T=o.forwardRef(({className:e,children:a,...r},o)=>(0,t.jsxs)(C.l9,{ref:o,className:(0,h.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[a,(0,t.jsx)(C.In,{asChild:!0,children:(0,t.jsx)(j.A,{className:"h-4 w-4 opacity-50"})})]}));T.displayName=C.l9.displayName;let R=o.forwardRef(({className:e,...a},r)=>(0,t.jsx)(C.PP,{ref:r,className:(0,h.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:(0,t.jsx)(k.A,{className:"h-4 w-4"})}));R.displayName=C.PP.displayName;let U=o.forwardRef(({className:e,...a},r)=>(0,t.jsx)(C.wn,{ref:r,className:(0,h.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:(0,t.jsx)(j.A,{className:"h-4 w-4"})}));U.displayName=C.wn.displayName;let D=o.forwardRef(({className:e,children:a,position:r="popper",...o},i)=>(0,t.jsx)(C.ZL,{children:(0,t.jsxs)(C.UC,{ref:i,className:(0,h.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...o,children:[(0,t.jsx)(R,{}),(0,t.jsx)(C.LM,{className:(0,h.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,t.jsx)(U,{})]})}));D.displayName=C.UC.displayName,o.forwardRef(({className:e,...a},r)=>(0,t.jsx)(C.JU,{ref:r,className:(0,h.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a})).displayName=C.JU.displayName;let L=o.forwardRef(({className:e,children:a,...r},o)=>(0,t.jsxs)(C.q7,{ref:o,className:(0,h.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(C.VF,{children:(0,t.jsx)(I.A,{className:"h-4 w-4"})})}),(0,t.jsx)(C.p4,{children:a})]}));L.displayName=C.q7.displayName,o.forwardRef(({className:e,...a},r)=>(0,t.jsx)(C.wv,{ref:r,className:(0,h.cn)("-mx-1 my-1 h-px bg-muted",e),...a})).displayName=C.wv.displayName;var O=r(80013),M=r(49384);let q={initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.3}},hover:{scale:1.02,transition:{duration:.2}},tap:{scale:.98,transition:{duration:.1}}},z={initial:{opacity:0,y:-10},animate:{opacity:1,y:0,transition:{duration:.2}},exit:{opacity:0,y:-10,transition:{duration:.2}}},B={initial:{opacity:0,x:-10},animate:{opacity:1,x:0,transition:{duration:.2}}},H=o.memo(function({categories:e,categoryId:a,setCategoryId:r,className:i,required:s=!1}){let l=o.useMemo(()=>e.find(e=>e.id===a),[e,a]),c=o.useCallback(e=>{r(e)},[r]);return(0,t.jsxs)("div",{className:(0,M.A)("space-y-2",i),children:[(0,t.jsx)(O.J,{htmlFor:"categoryId",className:"text-sm font-medium text-foreground capitalize",children:"Category"}),(0,t.jsx)(n.P.div,{variants:q,initial:"initial",animate:"animate",whileHover:"hover",whileTap:"tap",children:(0,t.jsxs)(S,{name:"categoryId",onValueChange:c,value:a,required:s,children:[(0,t.jsx)(T,{id:"categoryId",className:(0,M.A)("w-full h-12 bg-background border border-input rounded-xl","text-foreground placeholder-muted-foreground","focus:ring-2 focus:ring-primary focus:border-primary","hover:bg-accent/50 transition-all duration-200","bg-gradient-to-r from-primary/10 to-secondary/10"),"aria-label":"Select product category","aria-required":s,children:(0,t.jsx)(F,{placeholder:"Select a category",children:l?.name||"Select a category"})}),(0,t.jsx)(d.N,{children:(0,t.jsx)(D,{className:(0,M.A)("bg-background border border-border rounded-xl shadow-lg","text-foreground max-h-60 overflow-y-auto z-50"),children:(0,t.jsx)(n.P.div,{variants:z,initial:"initial",animate:"animate",exit:"exit",children:(0,t.jsx)(E,{children:e.length>0?e.map(e=>(0,t.jsx)(n.P.div,{variants:B,className:"px-4 py-2",children:(0,t.jsx)(L,{value:e.id,className:(0,M.A)("text-foreground hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground","transition-colors duration-150 cursor-pointer rounded-md"),children:e.name})},e.id)):(0,t.jsx)("div",{className:"px-4 py-2 text-muted-foreground italic","aria-live":"polite",children:"No categories available"})})})})})]})})]})});var V=r(89667),_=r(88233),J=r(96474),G=function(e){return e.ProductTechS="ProductTechS",e.ProductAddonS="ProductAddonS",e}({});let Q={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:-10,transition:{duration:.2}}},K={hidden:{opacity:0,scale:.95,transition:{duration:.2}},visible:{opacity:1,scale:1,transition:{duration:.2}},hover:{scale:1.05,transition:{duration:.2}},tap:{scale:.95,transition:{duration:.1}}};function W({onChange:e,index:a,item:r,currentState:i,optionKey:n}){let d=(0,o.useMemo)(()=>[s.PackageOption.FullStack,s.PackageOption.Backend,s.PackageOption.Frontend,s.PackageOption.UI,s.PackageOption.UX],[]),l=(0,o.useMemo)(()=>d.filter(e=>!i.some(a=>a.name===e)||r.name===e),[i,r.name]);return(0,t.jsxs)(S,{onValueChange:a=>e("name",a),value:r.name||"",required:!0,children:[(0,t.jsx)(T,{className:(0,M.A)("w-full p-3 rounded-md bg-background text-foreground border border-input","focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background","hover:bg-accent/50"),"aria-label":"Select addon option","aria-required":"true",children:(0,t.jsx)(F,{placeholder:"Select Addon"})}),(0,t.jsx)(D,{className:(0,M.A)("rounded-xl shadow-lg z-50 max-h-64 overflow-y-auto","bg-background border border-border text-foreground"),children:(0,t.jsx)(E,{children:l.length>0?l.map((e,a)=>(0,t.jsx)(L,{value:e,className:(0,M.A)("text-foreground hover:bg-accent hover:text-accent-foreground","transition-all duration-200 cursor-pointer py-2 px-4"),children:e},a)):(0,t.jsx)("div",{className:"text-muted-foreground text-center py-2",children:"No options available"})})})]})}let X=function({state:e,setState:a,optionKey:r,className:i,placeholder:s="Enter option",validate:l=()=>null}){let[c,u]=(0,o.useState)(!1),p="ProductTechS"===r,m=p||e.length<1,{addOption:g,onChange:h,removeOption:x}=(0,o.useCallback)(()=>({addOption:async()=>{if(!p&&e.length>=1)return void f.oR.error("Only one addon is allowed.",{icon:(0,t.jsx)(_.A,{className:"w-5 h-5 text-red-400"}),style:{backgroundColor:"#4E1313",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"10px",padding:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}});u(!0);try{if(e.length>0){let a=e[e.length-1],r=l(a);if(r)return void f.oR.error(r,{icon:(0,t.jsx)(_.A,{className:"w-5 h-5 text-red-400"}),style:{backgroundColor:"#4E1313",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"10px",padding:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}})}a(e=>[...e,{name:""}]),f.oR.success(`${p?"Technology":"Addon"} added`,{icon:(0,t.jsx)(J.A,{className:"w-5 h-5 text-green-400"}),style:{backgroundColor:"#1A3C34",color:"#6EE7B7",border:"1px solid #6EE7B7",borderRadius:"10px",padding:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}})}catch(e){f.oR.error("Failed to add option",{icon:(0,t.jsx)(_.A,{className:"w-5 h-5 text-red-400"}),style:{backgroundColor:"#4E1313",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"10px",padding:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}})}finally{u(!1)}},onChange:(e,r)=>{a(a=>{let t=[...a];return t[e]=r,t})},removeOption:e=>{a(a=>a.filter((a,r)=>r!==e)),f.oR.success(`${p?"Technology":"Addon"} removed`,{icon:(0,t.jsx)(_.A,{className:"w-5 h-5 text-green-400"}),style:{backgroundColor:"#1A3C34",color:"#6EE7B7",border:"1px solid #6EE7B7",borderRadius:"10px",padding:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}})}}),[a,e,l,p])();return(0,t.jsxs)("div",{className:(0,M.A)("space-y-6",i),children:[(0,t.jsx)(d.N,{children:e.length>0&&(0,t.jsx)(n.P.ul,{className:"space-y-4",initial:"hidden",animate:"visible",exit:"exit",variants:{visible:{transition:{staggerChildren:.1}}},children:e.map((a,o)=>(0,t.jsxs)(n.P.li,{variants:Q,className:(0,M.A)("flex items-end gap-4 p-4 rounded-xl shadow-sm","bg-background border border-border","hover:shadow-md transition-all duration-300"),role:"listitem","aria-label":`${p?"Technology":"Addon"} option ${o+1}`,children:[(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(O.J,{className:"text-sm font-medium text-foreground",htmlFor:`${r}-${o}-name`,children:p?"Technology":"Addon Name"}),p?(0,t.jsx)(V.p,{id:`${r}-${o}-name`,type:"text",placeholder:s,value:a.name??"",onChange:e=>h(o,{...a,name:e.target.value}),className:(0,M.A)("w-full p-3 rounded-md bg-background text-foreground border border-input","focus:ring-2 focus:ring-primary focus:border-primary","placeholder-muted-foreground"),required:!0,"aria-required":"true"}):(0,t.jsx)(W,{item:a,onChange:(e,r)=>h(o,{...a,[e]:r}),index:o,currentState:e,optionKey:r})]}),(0,t.jsx)(n.P.div,{variants:K,whileHover:"hover",whileTap:"tap",children:(0,t.jsx)(v.$,{type:"button",variant:"outline",size:"icon",onClick:()=>x(o),className:(0,M.A)("flex-shrink-0 border-destructive text-destructive hover:bg-destructive/10 hover:text-destructive","focus:ring-2 focus:ring-destructive focus:ring-offset-2 focus:ring-offset-background"),"aria-label":`Remove ${p?"technology":"addon"} option ${o+1}`,children:(0,t.jsx)(_.A,{className:"w-5 h-5"})})})]},o))})}),(0,t.jsx)(d.N,{children:m&&(0,t.jsx)(n.P.div,{variants:K,initial:"hidden",animate:"visible",exit:"hidden",whileHover:"hover",whileTap:"tap",children:(0,t.jsxs)(v.$,{type:"button",variant:"outline",className:(0,M.A)("w-full py-3 rounded-xl shadow-sm","bg-gradient-to-r from-primary to-secondary text-primary-foreground border border-primary/50","hover:bg-primary/80 hover:border-primary focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background","flex items-center justify-center gap-2",c&&"opacity-50 cursor-not-allowed"),onClick:g,disabled:c,"aria-label":`Add new ${p?"technology":"addon"} option`,"aria-disabled":c?"true":"false",children:[(0,t.jsx)(J.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:p?"Add Technology":"Add Addon"}),c&&(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 ml-2 text-primary-foreground",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})]})})})]})};var Y=r(23689),Z=r(83281),ee=r(28559),ea=r(51361),er=r(43125),et=r(77181);let eo={initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1,transition:{duration:.5,ease:"easeOut"}},exit:{opacity:0,scale:.9,transition:{duration:.6,ease:"easeInOut"}}},ei=()=>(0,t.jsxs)(n.P.div,{className:"fixed inset-0 flex items-center justify-center bg-gray-900/95 backdrop-blur-sm z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:[(0,t.jsx)(n.P.div,{animate:{rotate:360,scale:[1,1.2,1]},transition:{repeat:1/0,duration:1.5,ease:"easeInOut"},className:"h-16 w-16 border-t-4 border-indigo-500 rounded-full"}),(0,t.jsx)(n.P.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"absolute mt-24 text-indigo-200 text-lg font-medium",children:"Saving your product..."})]}),en=({selectedImage:e,setSelectedImage:a,className:r})=>{let i=(0,o.useCallback)(e=>{let r=e.target.files?.[0];r&&r.size<=5242880?a(URL.createObjectURL(r)):f.oR.error("Image must be under 5MB",{style:{background:"linear-gradient(135deg, #4E1313, #7F1D1D)",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"12px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.3)"}})},[a]);return(0,t.jsxs)(n.P.div,{className:(0,h.cn)("group relative w-56 h-56 overflow-hidden rounded-xl border-2 border-indigo-600/30 shadow-lg hover:shadow-xl transition-all duration-300",r),whileHover:{scale:1.03},whileTap:{scale:.97},children:[e?(0,t.jsx)(y.default,{src:e,alt:"Product Image",width:224,height:224,className:"rounded-xl object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-gray-800/50 rounded-xl flex items-center justify-center",children:(0,t.jsx)(ea.A,{className:"w-12 h-12 text-indigo-400"})}),(0,t.jsxs)("div",{className:(0,h.cn)("absolute inset-0 bg-indigo-600/20 flex items-center justify-center transition-opacity duration-300",e?"group-hover:opacity-100 opacity-0":"opacity-100"),children:[(0,t.jsx)("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:i,name:"image","aria-label":"Upload product image"}),(0,t.jsx)("label",{htmlFor:"image-upload",className:"w-full h-full flex items-center justify-center cursor-pointer",children:(0,t.jsx)(ea.A,{className:"w-10 h-10 text-indigo-200 drop-shadow-md"})})]})]})},ed=({pending:e,product:a})=>{let[r,i]=(0,o.useState)({pending:!1,status:null,message:""}),d=(0,o.useCallback)(async e=>{try{i(e=>({...e,pending:!0}));let a=await g(e);i(e=>({...e,status:a.status,message:a.message}))}catch(e){console.error("[FormActions] Delete error:",e),i(e=>({...e,status:500,message:"An unexpected error occurred"}))}finally{i(e=>({...e,pending:!1}))}},[]);return(0,o.useEffect)(()=>{if(r.message&&r.status&&!r.pending){let e=200===r.status;f.oR[e?"success":"error"](r.message,{icon:e?(0,t.jsx)(Y.A,{className:"w-5 h-5 text-green-400"}):(0,t.jsx)(Z.A,{className:"w-5 h-5 text-red-400"}),style:{background:e?"linear-gradient(135deg, #1A3C34, #2D6A4F)":"linear-gradient(135deg, #4E1313, #7F1D1D)",color:e?"#6EE7B7":"#FCA5A5",border:`1px solid ${e?"#6EE7B7":"#FCA5A5"}`,borderRadius:"12px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",gap:"12px"},position:"top-right",duration:3e3})}},[r.message,r.status,r.pending]),(0,t.jsxs)("div",{className:"flex flex-col gap-4 mt-6",children:[(0,t.jsxs)("div",{className:(0,h.cn)("grid",a?"grid-cols-2":"grid-cols-1","gap-4"),children:[(0,t.jsx)(n.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,t.jsx)(v.$,{type:"submit",disabled:e,className:(0,h.cn)("bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold py-3 rounded-lg","hover:from-indigo-700 hover:to-purple-700 border border-indigo-600/30","focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 focus:ring-offset-gray-900","shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2",e&&"opacity-60 cursor-not-allowed"),"aria-label":a?"Update product":"Add product",children:e?(0,t.jsx)(er.A,{className:"w-5 h-5 text-white animate-spin"}):a?"Update Product":"Add Product"})}),a&&(0,t.jsx)(n.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,t.jsx)(v.$,{variant:"outline",disabled:r.pending,onClick:()=>d(a.id),className:(0,h.cn)("border-indigo-600/30 text-indigo-300 font-semibold py-3 rounded-lg","hover:bg-indigo-600/20 hover:text-white","focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 focus:ring-offset-gray-900","shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2",r.pending&&"opacity-60 cursor-not-allowed"),"aria-label":"Delete product",children:r.pending?(0,t.jsx)(er.A,{className:"w-5 h-5 text-indigo-300 animate-spin"}):"Delete Product"})})]}),(0,t.jsx)(n.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,t.jsx)(b(),{href:`/${l.BV.ADMIN}/${l.bQ.MENU_ITEMS}`,className:(0,v.r)({variant:"outline",className:(0,h.cn)("w-full text-center font-semibold border border-indigo-600/30","py-3 rounded-lg text-indigo-300","hover:bg-indigo-600/20 hover:text-white","focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 focus:ring-offset-gray-900","shadow-lg hover:shadow-xl transition-all duration-300")}),"aria-label":"Cancel and return to menu items",children:"Cancel"})})]})},es=({productTechs:e,setProductTechs:a})=>(0,t.jsx)(A,{type:"single",collapsible:!0,className:"bg-gray-800/50 border border-indigo-600/30 rounded-xl shadow-md",children:(0,t.jsxs)(N,{value:"item-1",className:"border-none",children:[(0,t.jsx)($,{className:(0,h.cn)("text-indigo-300 text-xl font-semibold px-4 py-3","hover:bg-indigo-600/20 hover:text-white","focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 focus:ring-offset-gray-900","transition-all duration-300"),"aria-label":"Toggle product technologies",children:"Product Technologies"}),(0,t.jsx)(P,{className:"px-4 py-3 text-indigo-200",children:(0,t.jsx)(X,{optionKey:G.ProductTechS,state:e,setState:a,className:"bg-gray-800/50 text-indigo-200 border-indigo-600/30 rounded-lg",placeholder:"Add technology (e.g., React, TypeScript)",validate:e=>e.name?.trim()?null:"Technology name is required"})})]})}),el=({productAddons:e,setProductAddons:a})=>(0,t.jsx)(A,{type:"single",collapsible:!0,className:"bg-gray-800/50 border border-indigo-600/30 rounded-xl shadow-md",children:(0,t.jsxs)(N,{value:"item-1",className:"border-none",children:[(0,t.jsx)($,{className:(0,h.cn)("text-indigo-300 text-xl font-semibold px-4 py-3","hover:bg-indigo-600/20 hover:text-white","focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 focus:ring-offset-gray-900","transition-all duration-300"),"aria-label":"Toggle product addons",children:"Product Addons"}),(0,t.jsx)(P,{className:"px-4 py-3 text-indigo-200",children:(0,t.jsx)(X,{optionKey:G.ProductAddonS,state:e,setState:a,className:"bg-gray-800/50 text-indigo-200 border-indigo-600/30 rounded-lg",placeholder:"Select addon (e.g., FullStack, Backend)",validate:e=>e.name?.trim()?Object.values(s.PackageOption).includes(e.name)?null:"Invalid addon name":"Addon name is required"})})]})}),ec=function({categories:e,product:a}){(0,i.useRouter)();let[r,s]=(0,o.useState)(a?.image??null),[u,g]=(0,o.useState)(a?.categoryId??e[0]?.id??""),[x,y]=(0,o.useState)(a?.ProductTech??[]),[v,w]=(0,o.useState)(a?.ProductAddon??[{name:"Backend"}]),[j,A]=(0,o.useState)(!1),{getFormFields:N}=(0,c.A)({slug:`${l.BV.ADMIN}/${l.bQ.MENU_ITEMS}`}),[$,P]=(0,o.useState)(()=>({name:a?.name??"",description:a?.description??"",liveDemoLink:a?.liveDemoLink??"",gitHubLink:a?.gitHubLink??""})),[C,k,I]=(0,o.useActionState)(a?p.bind(null,{productId:a.id,options:{productTechs:x,productAddons:v}}):m.bind(null,{categoryId:u,options:{productTechs:x,productAddons:v}}),{message:"",error:{},status:null,formData:null}),S=(0,o.useCallback)(e=>a=>{let r=a.target.value;console.log(`[Form] Field Change: ${e} = "${r}" (type: ${a.target.type}, id: ${a.target.id})`),P(a=>{let t={...a,[e]:r};return console.log("[Form] Updated formValues:",t),t})},[]);return(0,t.jsx)(d.N,{mode:"wait",children:j?(0,t.jsx)(ei,{},"loader"):(0,t.jsxs)(n.P.form,{action:e=>{let t=["name","description"].filter(e=>!$[e]||""===$[e].toString().trim());if(t.length>0)return void f.oR.error(`Please fill in: ${t.join(", ")}`,{style:{background:"linear-gradient(135deg, #4E1313, #7F1D1D)",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"12px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.3)"}});if(!a&&!r){let a=document.querySelector("#image-upload");if(!a?.files?.[0])return void f.oR.error("Please upload an image",{style:{background:"linear-gradient(135deg, #4E1313, #7F1D1D)",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"12px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.3)"}});e.append("image",a.files[0])}if(!u)return void f.oR.error("Please select a category",{style:{background:"linear-gradient(135deg, #4E1313, #7F1D1D)",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"12px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.3)"}});if(1!==v.length)return void f.oR.error("Exactly one product addon is required",{style:{background:"linear-gradient(135deg, #4E1313, #7F1D1D)",color:"#FCA5A5",border:"1px solid #FCA5A5",borderRadius:"12px",padding:"16px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.3)"}});e.append("categoryId",u),Object.entries($).forEach(([a,r])=>{let t=r?.toString()||"";e.append(a,t),console.log(`[Form] Appending to FormData: ${a} = "${t}"`)}),e.append("productTechs",JSON.stringify(x)),e.append("productAddons",JSON.stringify(v));let o={};e.forEach((e,a)=>{o[a]=e instanceof File?`[File: ${e.name}]`:e}),console.log("[Form] FormData Keys:",Array.from(e.keys())),console.log("[Form] FormData:",o),k(e)},variants:eo,initial:"initial",animate:"animate",exit:"exit",className:"relative flex flex-col md:flex-row gap-8 p-8 bg-gray-900/90 rounded-2xl shadow-2xl border border-indigo-600/30 max-w-4xl mx-auto backdrop-blur-md",role:"form","aria-labelledby":"product-form-title",children:[(0,t.jsx)("h2",{id:"product-form-title",className:"sr-only",children:a?"Update Product":"Add Product"}),(0,t.jsx)("div",{className:"absolute top-4 right-4",children:(0,t.jsxs)(b(),{href:`/${l.BV.ADMIN}/${l.bQ.MENU_ITEMS}`,className:"flex items-center gap-2 text-indigo-400 hover:text-indigo-200 transition-colors duration-300 group","aria-label":"Back to menu items",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Back to Menu"}),(0,t.jsx)(ee.A,{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform duration-300"})]})}),(0,t.jsxs)(n.P.div,{className:"flex-shrink-0 pt-8",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[(0,t.jsx)(en,{className:(0,h.cn)("bg-gray-900/90 border border-indigo-600/30 rounded-xl p-3 shadow-md"),selectedImage:r,setSelectedImage:s}),C?.error?.image&&(0,t.jsxs)(n.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:(0,h.cn)("text-sm text-red-400 font-medium text-center mt-3 flex items-center gap-2 bg-red-500/10 border border-red-500/30 rounded-lg p-2"),"aria-live":"polite",children:[(0,t.jsx)("span",{className:"text-red-400",children:"⚠"})," ",C.error.image]})]}),(0,t.jsxs)(n.P.div,{className:"flex-1 space-y-6 pt-8",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:[(0,t.jsx)("div",{className:"grid gap-4",children:N().map(e=>(0,t.jsxs)(n.P.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:["gitHubLink"===e.name||"liveDemoLink"===e.name?(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:e.name,className:"text-indigo-300 font-medium text-sm",children:e.label}),(0,t.jsx)("input",{id:e.name,name:e.name,type:"url",placeholder:e.placeholder,pattern:e.pattern,value:$[e.name]??"",onChange:S(e.name),className:(0,h.cn)("w-full p-3 bg-gray-800/50 border border-indigo-600/30 rounded-lg","text-indigo-200 placeholder-indigo-400/50","focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400/50","transition-all duration-300",C?.error?.[e.name]&&"border-red-500/30"),"aria-label":e.ariaLabel})]}):(0,t.jsx)(et.A,{...e,type:e.type,error:C?.error?.[e.name],value:$[e.name]??"",defaultValue:$[e.name]??"",onChange:S(e.name),className:(0,h.cn)("w-full p-3 bg-gray-800/50 border border-indigo-600/30 rounded-lg","text-indigo-200 placeholder-indigo-400/50","focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400/50","transition-all duration-300",C?.error?.[e.name]&&"border-red-500/30")}),C?.error?.[e.name]&&(0,t.jsxs)(n.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:(0,h.cn)("text-sm text-red-400 font-medium mt-1 flex items-center gap-2 bg-red-500/10 border border-red-500/30 rounded-lg p-2"),"aria-live":"polite",children:[(0,t.jsx)("span",{className:"text-red-400",children:"⚠"}),C.error[e.name]]})]},e.name))}),(0,t.jsxs)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},children:[(0,t.jsx)(H,{categoryId:u,categories:e,setCategoryId:g,className:(0,h.cn)("w-full p-3 bg-gray-800/50 border border-indigo-600/30 rounded-lg","text-indigo-200","focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400/50","transition-all duration-300",C?.error?.categoryId&&"border-red-500/30")}),C?.error?.categoryId&&(0,t.jsxs)(n.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:(0,h.cn)("text-sm text-red-400 font-medium mt-1 flex items-center gap-2 bg-red-500/10 border border-red-500/30 rounded-lg p-2"),"aria-live":"polite",children:[(0,t.jsx)("span",{className:"text-red-400",children:"⚠"})," ",C.error.categoryId]})]}),(0,t.jsx)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.5},children:(0,t.jsx)(es,{productTechs:x,setProductTechs:y})}),(0,t.jsx)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.6},children:(0,t.jsx)(el,{productAddons:v,setProductAddons:w})}),(0,t.jsx)(n.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.7},children:(0,t.jsx)(ed,{pending:I,product:a})})]})]},"form")})}},41941:(e,a,r)=>{r.r(a),r.d(a,{"7f5d17a3c69a806267bbdf1348d85c4e2287242b1e":()=>N,"7f86c3aae7be9af34f044b37529fe3eff2b5a3efb6":()=>A,"7fd87313ccd012edb02f7921a3095364ea6a8b73f2":()=>$});var t=r(91199);r(42087);var o=r(70664),i=r(56728),n=r(16672),d=r(96330);let s={requiredName:"Product name is required",requiredDescription:"Product description is required",requiredCategory:"Category is required",requiredImage:"Product image is required",invalidImage:"Image must be a valid file (JPEG, PNG, GIF, WebP, SVG, BMP) under 15MB",requiredTech:"At least one technology is required",invalidTech:"Technology name is required",requiredAddon:"Exactly one addon is required",invalidAddon:"Addon must be a valid package option (FullStack, Backend, Frontend, UI, UX)",tooManyAddons:"Only one addon is allowed",invalidLiveDemoLink:"Live demo link must be a valid URL",invalidGitHubLink:"GitHub link must be a valid GitHub repository URL (e.g., https://github.com/user/repo)"},l=["image/jpeg","image/png","image/gif","image/webp","image/svg+xml","image/bmp"],c=e=>"string"!=typeof e?"":e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<[^>]+>/g,"").trim(),u=e=>n.z.instanceof(File,{message:s.invalidImage}).optional().refine(a=>!e||null!=a&&a.size>0,{message:s.requiredImage}).refine(e=>!e||l.includes(e.type)&&e.size<=0xf00000,{message:s.invalidImage}),p=()=>({productTechs:n.z.array(n.z.object({name:n.z.string().trim().min(1,{message:s.invalidTech})})).min(1,{message:s.requiredTech}).default([]),productAddons:n.z.array(n.z.object({name:n.z.enum(Object.values(d.PackageOption),{message:s.invalidAddon})})).min(1,{message:s.requiredAddon}).max(1,{message:s.tooManyAddons}).default([])}),m=()=>({name:n.z.preprocess(c,n.z.string().trim().min(1,{message:s.requiredName}).max(100,{message:"Product name must be less than 100 characters"})),description:n.z.preprocess(c,n.z.string().trim().min(1,{message:s.requiredDescription}).max(1e3,{message:"Description must be less than 1000 characters"})),categoryId:n.z.string().uuid({message:s.requiredCategory}),liveDemoLink:n.z.string().optional().refine(e=>!e||n.z.string().url().safeParse(e).success,{message:s.invalidLiveDemoLink}),gitHubLink:n.z.string().optional().refine(e=>!e||n.z.string().url().safeParse(e).success&&/^https?:\/\/(www\.)?github\.com\/[\w-]+\/[\w-]+(\/.*)?$/.test(e),{message:s.invalidGitHubLink}),...p()}),g=()=>n.z.object({...m(),image:u(!0)});var f=r(7944),h=r(33331);let x=["image/jpeg","image/png","image/gif","image/webp","image/svg+xml","image/bmp"],b="[ServerActions]",y=e=>new Promise(a=>setTimeout(a,e)),v=async e=>{let a=crypto.randomUUID();if(console.log(`${b} [${a}] Validating image: ${e.name} (${e.size} bytes, type: ${e.type})`),!x.includes(e.type))throw console.error(`${b} [${a}] Invalid image type: ${e.type}`),Error(`Invalid image type: ${e.type}. Supported types: ${x.join(", ")}`);if(e.size>0xf00000){let r=(e.size/1048576).toFixed(2);throw console.error(`${b} [${a}] Image too large: ${r}MB`),Error(`Image size (${r}MB) exceeds the 15MB limit`)}let r=new FormData;r.append("file",e),r.append("pathName","product_images");let t=null;for(let e=1;e<=3;e++)try{console.log(`${b} [${a}] Upload attempt ${e}`);let t=await fetch("http://localhost:3000/api/upload",{method:"POST",body:r});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`);let o=await t.json();if(!o?.url)throw Error("Invalid response: Missing image URL");return console.log(`${b} [${a}] Image uploaded: ${o.url}`),o.url}catch(r){if(t=r instanceof Error?r:Error("Unknown upload error"),console.error(`${b} [${a}] Upload attempt ${e} failed: ${t.message}`),e<3){let r=1e3*Math.pow(2,e-1);console.log(`${b} [${a}] Retrying after ${r}ms`),await y(r)}}throw console.error(`${b} [${a}] Image upload failed after 3 attempts`),t||Error("Image upload failed")},w=async e=>{let a=[`/${i.BV.MENU}`,`/${i.BV.ADMIN}/${i.bQ.MENU_ITEMS}`,e?`/${i.BV.ADMIN}/${i.bQ.MENU_ITEMS}/${e}/${i.bQ.EDIT}`:null,"/"].filter(Boolean);console.log(`${b} Revalidating paths: ${a.join(", ")}`),await Promise.all(a.map(e=>(0,f.revalidatePath)(e)))},j=e=>{if(0===e.productTechs.length)return{status:400,message:"At least one technology is required"};for(let a of e.productTechs)if(!a.name?.trim())return{status:400,message:"All technologies must have a valid name"};if(1!==e.productAddons.length)return{status:400,message:"Exactly one product addon is required"};let a=e.productAddons[0];return a.name&&Object.values(d.PackageOption).includes(a.name)?null:{status:400,message:`Invalid addon name: ${a.name||"undefined"}. Expected one of: ${Object.values(d.PackageOption).join(", ")}`}},A=async(e,a,r)=>{let t=crypto.randomUUID();console.log(`${b} [${t}] Processing addProduct`);try{let a={};r.forEach((e,r)=>{a[r]=e instanceof File?`[File: ${e.name}]`:e}),console.log(`${b} [${t}] Raw FormData:`,a);let i=r.get("productTechs"),n=r.get("productAddons"),s=r.get("gitHubLink"),l=i?JSON.parse(i).map(e=>({name:e.name})):[],c=n?JSON.parse(n).map(e=>{if(!Object.values(d.PackageOption).includes(e.name))throw Error(`Invalid addon name: ${e.name}. Expected one of: ${Object.values(d.PackageOption).join(", ")}`);return{name:e.name}}):[],u={name:r.get("name"),description:r.get("description"),categoryId:e.categoryId,image:r.get("image"),productTechs:l,productAddons:c,liveDemoLink:r.get("liveDemoLink"),gitHubLink:""===s||null===s?void 0:s};console.log(`${b} [${t}] Validation Input:`,u);let p=g().safeParse(u);if(!p.success){let e=p.error.flatten();return console.log(`${b} [${t}] Validation Errors:`,e),{status:400,message:"Invalid form data",error:Object.fromEntries(Object.entries(e.fieldErrors).map(([e,a])=>[e,a?.join(", ")||""])),formData:r}}let{name:m,description:f,categoryId:h,image:x,productTechs:y,productAddons:A,liveDemoLink:N,gitHubLink:$}=p.data;if(console.log(`${b} [${t}] Validated Data:`,{name:m,description:f,categoryId:h,liveDemoLink:N,gitHubLink:$,productTechs:y,productAddons:A}),!x||0===x.size)return console.error(`${b} [${t}] No image provided`),{status:400,message:"An image is required",error:{image:"Image is required"}};let P=await v(x),C=j({productTechs:y.map(e=>({name:e.name})),productAddons:A.map(e=>({name:e.name}))});if(C)return console.error(`${b} [${t}] Options validation failed: ${C.message}`),C;let k=await o.db.product.create({data:{name:m,description:f,image:P,categoryId:h,liveDemoLink:N||null,gitHubLink:$||null,order:0,ProductTech:{createMany:{data:y.map(e=>({name:e.name}))}},ProductAddon:{createMany:{data:A.map(e=>({name:e.name}))}}}});return console.log(`${b} [${t}] Product created: ${k.id}`),await w(),{status:201,message:"Product added successfully"}}catch(e){return console.error(`${b} [${t}] Error:`,e),{status:500,message:`Failed to add product: ${e instanceof Error?e.message:"Unknown error"}`}}},N=async(e,a,r)=>{let t=crypto.randomUUID();console.log(`${b} [${t}] Processing updateProduct for ID: ${e.productId}`);try{let a={};r.forEach((e,r)=>{a[r]=e instanceof File?`[File: ${e.name}]`:e}),console.log(`${b} [${t}] Raw FormData:`,a);let i=r.get("productTechs"),n=r.get("productAddons"),s=r.get("gitHubLink"),l=i?JSON.parse(i).map(e=>({name:e.name})):[],c=n?JSON.parse(n).map(e=>{if(!Object.values(d.PackageOption).includes(e.name))throw Error(`Invalid addon name: ${e.name}. Expected one of: ${Object.values(d.PackageOption).join(", ")}`);return{name:e.name}}):[],u={name:r.get("name"),description:r.get("description"),categoryId:r.get("categoryId"),image:r.get("image"),productTechs:l,productAddons:c,liveDemoLink:r.get("liveDemoLink"),gitHubLink:""===s||null===s?void 0:s};console.log(`${b} [${t}] Validation Input:`,u);let p=g().safeParse(u);if(!p.success){let e=p.error.flatten();return console.log(`${b} [${t}] Validation Errors:`,e),{status:400,message:"Invalid form data",error:Object.fromEntries(Object.entries(e.fieldErrors).map(([e,a])=>[e,a?.join(", ")||""])),formData:r}}let{name:m,description:f,categoryId:h,image:x,productTechs:y,productAddons:A,liveDemoLink:N,gitHubLink:$}=p.data;console.log(`${b} [${t}] Validated Data:`,{name:m,description:f,categoryId:h,liveDemoLink:N,gitHubLink:$,productTechs:y,productAddons:A});let P=await o.db.product.findUnique({where:{id:e.productId}});if(!P)return console.error(`${b} [${t}] Product not found: ${e.productId}`),{status:404,message:"Product not found"};let C=P.image;x&&x.size>0&&(C=await v(x));let k=j({productTechs:y.map(e=>({name:e.name})),productAddons:A.map(e=>({name:e.name}))});if(k)return console.error(`${b} [${t}] Options validation failed: ${k.message}`),k;let I=await o.db.$transaction(async a=>{let r=await a.product.update({where:{id:e.productId},data:{name:m,description:f,image:C,categoryId:h,liveDemoLink:N||null,gitHubLink:$||null}});return await a.productTech.deleteMany({where:{productId:e.productId}}),await a.productAddon.deleteMany({where:{productId:e.productId}}),await a.productTech.createMany({data:y.map(a=>({productId:e.productId,name:a.name}))}),await a.productAddon.createMany({data:A.map(a=>({productId:e.productId,name:a.name}))}),r});return console.log(`${b} [${t}] Product updated: ${I.id}`),await w(I.id),{status:200,message:"Product updated successfully"}}catch(e){return console.error(`${b} [${t}] Error:`,e),{status:500,message:`Failed to update product: ${e instanceof Error?e.message:"Unknown error"}`}}},$=async e=>{let a=crypto.randomUUID();console.log(`${b} [${a}] Processing deleteProduct for ID: ${e}`);try{if(!await o.db.product.findUnique({where:{id:e}}))return console.error(`${b} [${a}] Product not found: ${e}`),{status:404,message:"Product not found"};return await o.db.product.delete({where:{id:e}}),console.log(`${b} [${a}] Product deleted: ${e}`),await w(e),{status:200,message:"Product deleted successfully"}}catch(e){return console.error(`${b} [${a}] Error:`,e),{status:500,message:`Failed to delete product: ${e instanceof Error?e.message:"Unknown error"}`}}};(0,h.D)([A,N,$]),(0,t.A)(A,"7f86c3aae7be9af34f044b37529fe3eff2b5a3efb6",null),(0,t.A)(N,"7f5d17a3c69a806267bbdf1348d85c4e2287242b1e",null),(0,t.A)($,"7fd87313ccd012edb02f7921a3095364ea6a8b73f2",null)},54348:(e,a,r)=>{r.d(a,{default:()=>o});var t=r(12907);let o=(0,t.registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\raya\\\\ShoppingCart\\\\portfolio - Copy - Copy - Copy\\\\src\\\\app\\\\admin\\\\menu-items\\\\_components\\\\Form.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy\\src\\app\\admin\\menu-items\\_components\\Form.tsx","default");(0,t.registerClientReference)(function(){throw Error("Attempted to call UploadImage() from the server but UploadImage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy\\src\\app\\admin\\menu-items\\_components\\Form.tsx","UploadImage"),(0,t.registerClientReference)(function(){throw Error("Attempted to call FormActions() from the server but FormActions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy\\src\\app\\admin\\menu-items\\_components\\Form.tsx","FormActions"),(0,t.registerClientReference)(function(){throw Error("Attempted to call AddProductTech() from the server but AddProductTech is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy\\src\\app\\admin\\menu-items\\_components\\Form.tsx","AddProductTech"),(0,t.registerClientReference)(function(){throw Error("Attempted to call AddProductAddons() from the server but AddProductAddons is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy\\src\\app\\admin\\menu-items\\_components\\Form.tsx","AddProductAddons")},89605:(e,a,r)=>{r.d(a,{P:()=>i});var t=r(62351),o=r(61120);function i(e,a,r){return(0,t.unstable_cache)((0,o.cache)(e),a,r)}}};