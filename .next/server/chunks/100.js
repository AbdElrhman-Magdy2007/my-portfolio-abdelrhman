exports.id=100,exports.ids=[100],exports.modules={9462:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"7f642c5e6f9d0df15461240c9981e17885ae03ee6d":()=>c});var a=r(91199);r(42087);var i=r(16672);let n=()=>i.z.object({name:i.z.string().trim().min(1,{message:"Name is required"}),email:i.z.string().trim().email({message:"Invalid email format"}),phone:i.z.string().trim().optional().refine(e=>!e||/^\+?[1-9]\d{1,14}$/.test(e),{message:"Invalid phone number"}),streetAddress:i.z.string().trim().optional(),postalCode:i.z.string().trim().optional().refine(e=>!e||/^\d{5,10}$/.test(e),{message:"Invalid postal code"}),city:i.z.string().trim().optional(),country:i.z.string().trim().optional(),image:i.z.any().optional().refine(e=>!e||"string"==typeof e||"undefined"!=typeof Blob&&e instanceof Blob&&e.size<=2097152&&e.type?.startsWith("image/"),{message:"Image must be under 2MB and of valid format"})});var o=r(70664),s=r(7944),l=r(56728),d=r(33331);let c=async(e,t,r)=>{let a,i=n().safeParse(Object.fromEntries(r.entries()));if(!i.success)return{error:i.error.formErrors.fieldErrors,formData:r};let d=i.data,c=d.image;"string"==typeof c?a=c:c instanceof Blob&&c.size>0&&(a=await u(c));try{let t=await o.z.user.findUnique({where:{email:d.email},select:{id:!0,email:!0,image:!0}});if(!t)return{message:"User not found",status:401,formData:r};return await o.z.user.update({where:{email:t.email},data:{name:d.name,phone:d.phone??null,streetAddress:d.streetAddress??null,postalCode:d.postalCode??null,city:d.city??null,country:d.country??null,image:a??t.image,role:e?l.gG.ADMIN:l.gG.USER}}),[`/${l.BV.PROFILE}`,`/${l.BV.ADMIN}`,`/${l.BV.ADMIN}/${l.bQ.USERS}`,`/${l.BV.ADMIN}/${l.bQ.USERS}/${t.id}/${l.bQ.EDIT}`].forEach(e=>(0,s.revalidatePath)(e)),{status:200,message:"Profile updated successfully"}}catch(e){return console.error("Update profile error:",e),{status:500,message:"An unexpected error occurred"}}},u=async e=>{if(e.size>5242880)throw Error("Image size exceeds 5MB limit");let t=new FormData;t.append("file",e),t.append("pathName","profile_images");try{let e=await fetch("http://localhost:3000/api/upload",{method:"POST",body:t});if(!e.ok)throw Error(`Upload failed: ${e.status}`);return(await e.json()).url}catch(e){console.warn("Upload error:",e);return}};(0,d.D)([c]),(0,a.A)(c,"7f642c5e6f9d0df15461240c9981e17885ae03ee6d",null)},26872:(e,t,r)=>{Promise.resolve().then(r.bind(r,86384))},30474:(e,t,r)=>{"use strict";r.d(t,{default:()=>i.a});var a=r(31261),i=r.n(a)},31261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return s}});let a=r(14985),i=r(44953),n=r(46533),o=a._(r(1933));function s(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=n.Image},51361:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(18962).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},56728:(e,t,r)=>{"use strict";r.d(t,{BV:()=>a,YG:()=>o,bQ:()=>i,gG:()=>n});var a=function(e){return e.ROOT="",e.MENU="menu",e.ABOUT="about",e.CONTACT="contact",e.AUTH="auth",e.CART="cart",e.PROFILE="profile",e.ADMIN="admin",e.PORTFOLIO="PORTFOLIO",e.SETTINGS="SETTINGS",e}({}),i=function(e){return e.LOGIN="/signin",e.Register="/signup",e.FORGOT_PASSWORD="forgot-password",e.CATEGORIES="categories",e.MENU_ITEMS="menu-items",e.USERS="users",e.ORDERS="orders",e.NEW="new",e.EDIT="edit",e.DASHBOARD="Dashboard",e.CUSTOMERS="Customers",e.SALES="Sales",e.PRODUCTS="PRODUCTS",e.LOGOUT="LOGOUT",e}({}),n=function(e){return e.ADMIN="ADMIN",e.USER="USER",e}({}),o=function(e){return e.FullStack="FullStack",e.Backend="Backend",e.Frontend="Frontend",e.UI="UI",e.UX="UX",e}({})},58111:(e,t,r)=>{"use strict";r.d(t,{AT:()=>a,B5:()=>o,BV:()=>i,bQ:()=>n});var a=function(e){return e.ENGLISH="en",e.ARABIC="ar",e}({}),i=function(e){return e.ROOT="",e.MENU="menu",e.ABOUT="about",e.CONTACT="contact",e.AUTH="auth",e.CART="cart",e.PROFILE="profile",e.ADMIN="admin",e.PORTFOLIO="PORTFOLIO",e.SETTINGS="SETTINGS",e}({}),n=function(e){return e.LOGIN="/signin",e.Register="/signup",e.FORGOT_PASSWORD="forgot-password",e.CATEGORIES="categories",e.MENU_ITEMS="menu-items",e.USERS="users",e.ORDERS="orders",e.NEW="new",e.EDIT="edit",e.DASHBOARD="Dashboard",e.CUSTOMERS="Customers",e.SALES="Sales",e.PRODUCTS="PRODUCTS",e.LOGOUT="LOGOUT",e}({}),o=function(e){return e.PROD="production",e.DEV="development",e}({})},61720:(e,t,r)=>{Promise.resolve().then(r.bind(r,96162))},70664:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var a=r(96330);let i=global.prisma||new a.PrismaClient},86384:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\raya\\\\ShoppingCart\\\\portfolio - Copy - Copy - Copy - Copy\\\\src\\\\components\\\\edit-user-form\\\\index.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\raya\\ShoppingCart\\portfolio - Copy - Copy - Copy - Copy\\src\\components\\edit-user-form\\index.tsx","default")},96162:(e,t,r)=>{"use strict";r.d(t,{default:()=>O});var a=r(60687),i=r(75109),n=r(28670),o=r(30474),s=r(29523),l=r(43210),d=r(6475);let c=(0,d.createServerReference)("7f642c5e6f9d0df15461240c9981e17885ae03ee6d",d.callServer,void 0,d.findSourceMapURL,"updateProfile");var u=r(43125),m=r(51361),p=r(52581),f=r(82136),g=r(62160),h=r(40211),S=r(19184),b=r(49384),y=function(e){return e.USER="USER",e.ADMIN="ADMIN",e}(y||{});let O=function({user:e}){let{data:t,update:r}=(0,f.useSession)(),[d,m]=(0,l.useState)(e.image??""),[y,O]=(0,l.useState)("ADMIN"===e.role),[x,R]=(0,l.useState)(null),[v,E]=(0,l.useState)([]),I=(0,l.useCallback)(()=>{let t=new FormData;return Object.entries(e).forEach(([e,r])=>{null!=r&&"image"!==e&&t.append(e,r.toString())}),t},[e]),T={message:"",error:{},status:null,formData:I()},[C,N,U]=(0,l.useActionState)(c.bind(null,y),T),{getFormFields:D}=(0,n.A)({slug:i.BV.PROFILE}),j=(0,l.useCallback)(e=>{e.preventDefault();let t="Saving...";t!==x&&(p.oR.loading(t,{id:"profile-update-loading",style:{borderRadius:"8px",padding:"12px",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb"}}),R(t)),(0,l.startTransition)(()=>{N(new FormData(e.currentTarget))})},[N,x]);return(0,a.jsxs)(S.P.form,{onSubmit:j,className:"flex flex-col md:flex-row gap-10 p-6 bg-black shadow-lg rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,a.jsxs)(S.P.div,{className:"group relative w-[200px] h-[200px] overflow-hidden rounded-full mx-auto border-2 border-indigo-700",whileHover:{scale:1.05},children:[d?(0,a.jsx)(o.default,{src:d,alt:e.name??"User Avatar",width:200,height:200,className:"rounded-full object-cover"}):(0,a.jsx)(o.default,{src:"https://i.postimg.cc/kg2xytVs/610e8961bbb935274c005c6106a78a38.jpg",alt:"Default Cat Avatar",width:200,height:200,className:"rounded-full object-cover"}),(0,a.jsx)("div",{className:(0,b.A)("absolute top-0 left-0 w-full h-full flex items-center justify-center rounded-full transition-opacity duration-200",d&&"group-hover:opacity-100 opacity-0 transition-opacity duration-200"),children:(0,a.jsx)(A,{setSelectedImage:m})})]}),(0,a.jsxs)(S.P.div,{className:"flex-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[D().map(e=>{let t=C?.formData?.get(e.name)??I().get(e.name);return(0,a.jsx)(S.P.div,{className:"mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,a.jsx)(g.A,{...e,type:e.type,pattern:e.pattern??"",ariaLabel:e.ariaLabel??"",defaultValue:t,error:C?.error?.[e.name]?.join(", "),readonly:e.type===i.gN.EMAIL,disabled:U})},e.name)}),t?.user.role==="ADMIN"&&(0,a.jsxs)(S.P.div,{className:"flex items-center gap-2 my-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[(0,a.jsx)(h.Sc,{id:"admin",name:"admin",checked:y,onCheckedChange:e=>O(e),className:(0,b.A)("w-5 h-5 border-2 rounded-md transition-all",y?"bg-indigo-700 border-indigo-700":"bg-black border-black")}),(0,a.jsx)("label",{htmlFor:"admin",className:"text-indigo-700 font-medium cursor-pointer",children:"Admin"})]}),(0,a.jsx)(S.P.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3},children:(0,a.jsx)(s.$,{type:"submit",disabled:U,className:(0,b.A)("w-full bg-indigo-700 hover:bg-indigo-700 text-black font-bold py-2 px-4 rounded-lg transition-all",U&&"opacity-50 cursor-not-allowed flex items-center justify-center gap-2"),children:U?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Saving..."})]}):"Save"})})]})]})},A=({setSelectedImage:e})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:t=>{let r=t.target.files?.[0];r&&e(URL.createObjectURL(r))},name:"image"}),(0,a.jsx)("label",{htmlFor:"image-upload",className:"flex justify-center items-center w-full h-full cursor-pointer ml-1 rounded-full hover:bg-indigo-700/700 transition-all",children:(0,a.jsx)(m.A,{className:"w-10 h-10 text-indigo-700"})})]})}};