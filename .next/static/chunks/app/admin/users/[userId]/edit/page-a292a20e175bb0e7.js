(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698,3937,6636],{6654:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return r}});let a=l(12115);function r(e,t){let l=(0,a.useRef)(null),r=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=l.current;e&&(l.current=null,e());let t=r.current;t&&(r.current=null,t())}else e&&(l.current=n(e,a)),t&&(r.current=n(t,a))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let l=e(t);return"function"==typeof l?l:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},14268:(e,t,l)=>{Promise.resolve().then(l.bind(l,24572))},24572:(e,t,l)=>{"use strict";l.d(t,{default:()=>v});var a=l(95155),r=l(53607),n=l(77052),i=l(66766),s=l(30285),o=l(46671),u=l(12115),d=l(34477);let c=(0,d.createServerReference)("7f1cc0a283f6cb3671dcffd6b0c729196e81c52dab",d.callServer,void 0,d.findSourceMapURL,"updateProfile");var f=l(94631),m=l(84355),p=l(56671),g=l(12108),b=l(26446),h=l(76981),x=l(58918),y=l(52596);let v=function(e){var t,l;let{user:d}=e,{data:m,update:v}=(0,g.useSession)(),[N,w]=(0,u.useState)(null!=(t=d.image)?t:""),[R,k]=(0,u.useState)(d.role===o.UserRole.ADMIN),[S,A]=(0,u.useState)(null),P=(0,u.useCallback)(()=>{let e=new FormData;return Object.entries(d).forEach(t=>{let[l,a]=t;null!=a&&"image"!==l&&e.append(l,a.toString())}),e},[d]),_={message:"",error:{},status:null,formData:P()},[C,D,E]=(0,u.useActionState)(c.bind(null,R),_),{getFormFields:M}=(0,n.A)({slug:r.BV.PROFILE});(0,u.useEffect)(()=>{if(C.message&&"number"==typeof C.status&&!E&&C.message!==S){p.oR.dismiss("profile-update-loading");let e=200===C.status;p.oR[e?"success":"error"](C.message,{style:{color:e?"#34c759":"#ef4444",backgroundColor:e?"#f0fdf4":"#fef2f2",border:"1px solid ".concat(e?"#dcfce7":"#fee2e2"),borderRadius:"8px",padding:"12px"},duration:3e3}),A(C.message),e&&v({...m,user:{...null==m?void 0:m.user,role:R?o.UserRole.ADMIN:o.UserRole.USER,image:N}})}},[E,C.message,C.status,m,v,R,N,S]),(0,u.useEffect)(()=>{var e;w(null!=(e=d.image)?e:"")},[d.image]);let O=(0,u.useCallback)(e=>{e.preventDefault();let t="Saving...";t!==S&&(p.oR.loading(t,{id:"profile-update-loading",style:{borderRadius:"8px",padding:"12px",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb"}}),A(t)),(0,u.startTransition)(()=>{D(new FormData(e.currentTarget))})},[D,S]);return(0,a.jsxs)(x.P.form,{onSubmit:O,className:"flex flex-col md:flex-row gap-10 p-6 bg-black shadow-lg rounded-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,a.jsxs)(x.P.div,{className:"group relative w-[200px] h-[200px] overflow-hidden rounded-full mx-auto border-2 border-indigo-700",whileHover:{scale:1.05},children:[N?(0,a.jsx)(i.default,{src:N,alt:null!=(l=d.name)?l:"User Avatar",width:200,height:200,className:"rounded-full object-cover"}):(0,a.jsx)(i.default,{src:"https://i.postimg.cc/kg2xytVs/610e8961bbb935274c005c6106a78a38.jpg",alt:"Default Cat Avatar",width:200,height:200,className:"rounded-full object-cover"}),(0,a.jsx)("div",{className:(0,y.A)("absolute top-0 left-0 w-full h-full flex items-center justify-center rounded-full transition-opacity duration-200",N&&"group-hover:opacity-100 opacity-0 transition-opacity duration-200"),children:(0,a.jsx)(j,{setSelectedImage:w})})]}),(0,a.jsxs)(x.P.div,{className:"flex-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[M().map(e=>{var t,l,n,i;let s=null!=(i=null==C||null==(t=C.formData)?void 0:t.get(e.name))?i:P().get(e.name);return(0,a.jsx)(x.P.div,{className:"mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:(0,a.jsx)(b.A,{...e,type:e.type,defaultValue:s,error:null==C||null==(n=C.error)||null==(l=n[e.name])?void 0:l.join(", "),readonly:e.type===r.gN.EMAIL,disabled:E})},e.name)}),(null==m?void 0:m.user.role)===o.UserRole.ADMIN&&(0,a.jsxs)(x.P.div,{className:"flex items-center gap-2 my-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:[(0,a.jsx)(h.Sc,{id:"admin",name:"admin",checked:R,onCheckedChange:e=>k(e),className:(0,y.A)("w-5 h-5 border-2 rounded-md transition-all",R?"bg-indigo-700 border-indigo-700":"bg-black border-black")}),(0,a.jsx)("label",{htmlFor:"admin",className:"text-indigo-700 font-medium cursor-pointer",children:"Admin"})]}),(0,a.jsx)(x.P.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3},children:(0,a.jsx)(s.$,{type:"submit",disabled:E,className:(0,y.A)("w-full bg-indigo-700 hover:bg-indigo-700 text-black font-bold py-2 px-4 rounded-lg transition-all",E&&"opacity-50 cursor-not-allowed flex items-center justify-center gap-2"),children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Saving..."})]}):"Save"})})]})]})},j=e=>{let{setSelectedImage:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",accept:"image/*",className:"hidden",id:"image-upload",onChange:e=>{var l;let a=null==(l=e.target.files)?void 0:l[0];a&&t(URL.createObjectURL(a))},name:"image"}),(0,a.jsx)("label",{htmlFor:"image-upload",className:"flex justify-center items-center w-full h-full cursor-pointer ml-1 rounded-full hover:bg-indigo-700/700 transition-all",children:(0,a.jsx)(m.A,{className:"w-10 h-10 text-indigo-700"})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1799,8918,8548,7951,3063,2108,3030,2563,8441,1684,7358],()=>t(14268)),_N_E=e.O()}]);